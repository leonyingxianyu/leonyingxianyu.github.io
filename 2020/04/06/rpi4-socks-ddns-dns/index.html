<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;auto&#34;"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico"><link rel="icon" href="/img/favicon.ico"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2a2a38"><meta name="description" content="写在前面我的网件路由器拿来当AP用了，所以没法使用梅林固件的插件进行魔法上网。手机电脑都还好，但是ns就比较蛋疼了，不挂代理下载慢的跟蜗牛一样，而且不知道为什么国内的一些dns会把ns访问的域名解析到美帝的节点去，所以就想了这么一出。（题目又臭又长请见谅）  "><meta name="author" content="咸鱼"><meta name="keywords" content=""><title>使用树莓派搭建透明代理、搭建本地DNS服务器及使用cloudflareAPI实现DDNS教程 - 咸鱼的小站</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"blog.xianyu.one",root:"/",version:"1.8.11",typing:{enable:!1,typeSpeed:70,cursorChar:"_",loop:!1},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},copy_btn:!0,image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,baidu:null,google:"UA-149461686-1",gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null}},search_path:"/local-search.xml"}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="咸鱼的小站" type="application/atom+xml">
</head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>咸鱼的小站</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> 友链</a></li><li class="nav-item"><a class="nav-link" target="_blank" rel="noopener" href="https://share.xianyu.one">分享站☁️</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner" id="banner" parallax="true" style="background:url(https://pic.imgdb.cn/item/5da29b9a9dc6d64c07a49301.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="使用树莓派搭建透明代理、搭建本地DNS服务器及使用cloudflareAPI实现DDNS教程">使用树莓派搭建透明代理、搭建本地DNS服务器及使用cloudflareAPI实现DDNS教程</span><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> 咸鱼 </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2020-04-06 20:25" pubdate>2020年4月6日 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 3.1k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 43 分钟</span></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">使用树莓派搭建透明代理、搭建本地DNS服务器及使用cloudflareAPI实现DDNS教程</h1><p class="note note-info">本文最后更新于：2021年5月9日 下午</p><div class="markdown-body"><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>我的网件路由器拿来当AP用了，所以没法使用梅林固件的插件进行魔法上网。手机电脑都还好，但是ns就比较蛋疼了，不挂代理下载慢的跟蜗牛一样，而且不知道为什么国内的一些dns会把ns访问的域名解析到美帝的节点去，所以就想了这么一出。（题目又臭又长请见谅）</p><span id="more"></span><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><h3 id="硬件"><a href="#硬件" class="headerlink" title="硬件"></a>硬件</h3><ul><li>树莓派4b（别的也行，反正差不多）</li><li>陈年MacBookAir</li><li>Windows电脑一台（下面我会解释为什么有Mac还要加台Windows的电脑）</li><li>网线一根</li><li>sd卡一张（大小随意，我用的是闪迪64gb A1的卡）</li><li>读卡器</li><li>树莓派对应充电线（4是type-c，之前是microUSB）<h3 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h3>~~分享站暂时下线，目前有点小问题 ~~已重新上线</li><li><a target="_blank" rel="noopener" href="https://ubuntu.com/download/raspberry-pi">Ubuntu18.04固件</a></li><li><a target="_blank" rel="noopener" href="https://www.balena.io/etcher/">balenaEtcher</a>（用于烧录固件）</li><li>ssh工具（这里我使用的是termius。AppStore有）</li></ul><h2 id="烧录系统"><a href="#烧录系统" class="headerlink" title="烧录系统"></a>烧录系统</h2><p>这一步其实很简单，把上面提到的Ubuntu的固件下载下来，然后在balenaEtcher中就可以一键刷入。<br>我的Mac不知道为什么这个软件用不了，正好家里有另一台笔记本能用就懒得折腾了。<br><code>Select image</code>那选中我们所要烧录的固件–&gt;<code>Select drive</code>选中我们所要烧录到的sd卡（做这一步的时候建议把别的什么储存卡之类的拔掉，并仔细确认选中的是对的。不要问我为什么）–&gt;点右边的flash等待完成刷入。</p><h2 id="树莓派开机及使用"><a href="#树莓派开机及使用" class="headerlink" title="树莓派开机及使用"></a>树莓派开机及使用</h2><p>将sd卡插到树莓派上，接上网线，插上供电线即可<br>等待网口的黄灯闪烁说明已将成功了<br>这时候我们需要登陆到路由器管理页面查看树莓派的ip（如果是动态ip的话需要将树莓派ip固定下来）<br>我的树莓派内网IP是<code>192.168.1.149</code><br>在ssh工具里填写好IP，同时使用的用户名是<code>ubuntu</code>，默认密码为<code>ubuntu</code>。第一次连接后会要求强制更改密码。<br>在接下去使用的过程中，需要使用root用户，请使用<code>sudo -i</code>将自己的用户更改为root<br>首先需要更改源，因为Ubuntu的官方源在国内还是比较慢的（后面还会降到更慢的）</p><h3 id="替换源"><a href="#替换源" class="headerlink" title="替换源"></a>替换源</h3><p>这里我们需要将文件中的所有源的地址更改为国内源的地址</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">vim <span class="hljs-regexp">/etc/</span>apt/sources.list    <span class="hljs-comment">#打开文件</span><br></code></pre></td></tr></table></figure><p>按i开启编辑模式，将文件中的所有网址替换为以下任意一种</p><h4 id="中科大源"><a href="#中科大源" class="headerlink" title="中科大源"></a>中科大源</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk">mirrors.ustc.edu.cn   <span class="hljs-comment">#中科大源</span><br><br><span class="hljs-comment">###############  你也可以选择先删光文件内容直接复制以下内容  ############</span><br><br>deb https:<span class="hljs-regexp">//mi</span>rrors.ustc.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic main restricted universe multiverse<br>deb-src https:<span class="hljs-regexp">//mi</span>rrors.ustc.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic main restricted universe multiverse<br>deb https:<span class="hljs-regexp">//mi</span>rrors.ustc.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-updates main restricted universe multiverse<br>deb-src https:<span class="hljs-regexp">//mi</span>rrors.ustc.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-updates main restricted universe multiverse<br>deb https:<span class="hljs-regexp">//mi</span>rrors.ustc.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-backports main restricted universe multiverse<br>deb-src https:<span class="hljs-regexp">//mi</span>rrors.ustc.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-backports main restricted universe multiverse<br>deb https:<span class="hljs-regexp">//mi</span>rrors.ustc.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-security main restricted universe multiverse<br>deb-src https:<span class="hljs-regexp">//mi</span>rrors.ustc.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-security main restricted universe multiverse<br>deb https:<span class="hljs-regexp">//mi</span>rrors.ustc.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-proposed main restricted universe multiverse<br>deb-src https:<span class="hljs-regexp">//mi</span>rrors.ustc.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-proposed main restricted universe multiverse<br></code></pre></td></tr></table></figure><h4 id="阿里云源"><a href="#阿里云源" class="headerlink" title="阿里云源"></a>阿里云源</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk">mirrors.aliyun.com    <span class="hljs-comment">#阿里云源</span><br><br><span class="hljs-comment">###############  你也可以选择先删光文件内容直接复制以下内容  ############</span><br><br>deb http:<span class="hljs-regexp">//mi</span>rrors.aliyun.com<span class="hljs-regexp">/ubuntu/</span> bionic main restricted universe multiverse<br>deb http:<span class="hljs-regexp">//mi</span>rrors.aliyun.com<span class="hljs-regexp">/ubuntu/</span> bionic-security main restricted universe multiverse<br>deb http:<span class="hljs-regexp">//mi</span>rrors.aliyun.com<span class="hljs-regexp">/ubuntu/</span> bionic-updates main restricted universe multiverse<br>deb http:<span class="hljs-regexp">//mi</span>rrors.aliyun.com<span class="hljs-regexp">/ubuntu/</span> bionic-proposed main restricted universe multiverse<br>deb http:<span class="hljs-regexp">//mi</span>rrors.aliyun.com<span class="hljs-regexp">/ubuntu/</span> bionic-backports main restricted universe multiverse<br>deb-src http:<span class="hljs-regexp">//mi</span>rrors.aliyun.com<span class="hljs-regexp">/ubuntu/</span> bionic main restricted universe multiverse<br>deb-src http:<span class="hljs-regexp">//mi</span>rrors.aliyun.com<span class="hljs-regexp">/ubuntu/</span> bionic-security main restricted universe multiverse<br>deb-src http:<span class="hljs-regexp">//mi</span>rrors.aliyun.com<span class="hljs-regexp">/ubuntu/</span> bionic-updates main restricted universe multiverse<br>deb-src http:<span class="hljs-regexp">//mi</span>rrors.aliyun.com<span class="hljs-regexp">/ubuntu/</span> bionic-proposed main restricted universe multiverse<br>deb-src http:<span class="hljs-regexp">//mi</span>rrors.aliyun.com<span class="hljs-regexp">/ubuntu/</span> bionic-backports main restricted universe multiverse<br></code></pre></td></tr></table></figure><h4 id="163源"><a href="#163源" class="headerlink" title="163源"></a>163源</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk">mirrors.<span class="hljs-number">163</span>.com      <span class="hljs-comment">#163源</span><br><br><span class="hljs-comment">###############  你也可以选择先删光文件内容直接复制以下内容  ############</span><br><br>deb http:<span class="hljs-regexp">//mi</span>rrors.<span class="hljs-number">163</span>.com<span class="hljs-regexp">/ubuntu/</span> bionic main restricted universe multiverse<br>deb http:<span class="hljs-regexp">//mi</span>rrors.<span class="hljs-number">163</span>.com<span class="hljs-regexp">/ubuntu/</span> bionic-security main restricted universe multiverse<br>deb http:<span class="hljs-regexp">//mi</span>rrors.<span class="hljs-number">163</span>.com<span class="hljs-regexp">/ubuntu/</span> bionic-updates main restricted universe multiverse<br>deb http:<span class="hljs-regexp">//mi</span>rrors.<span class="hljs-number">163</span>.com<span class="hljs-regexp">/ubuntu/</span> bionic-proposed main restricted universe multiverse<br>deb http:<span class="hljs-regexp">//mi</span>rrors.<span class="hljs-number">163</span>.com<span class="hljs-regexp">/ubuntu/</span> bionic-backports main restricted universe multiverse<br>deb-src http:<span class="hljs-regexp">//mi</span>rrors.<span class="hljs-number">163</span>.com<span class="hljs-regexp">/ubuntu/</span> bionic main restricted universe multiverse<br>deb-src http:<span class="hljs-regexp">//mi</span>rrors.<span class="hljs-number">163</span>.com<span class="hljs-regexp">/ubuntu/</span> bionic-security main restricted universe multiverse<br>deb-src http:<span class="hljs-regexp">//mi</span>rrors.<span class="hljs-number">163</span>.com<span class="hljs-regexp">/ubuntu/</span> bionic-updates main restricted universe multiverse<br>deb-src http:<span class="hljs-regexp">//mi</span>rrors.<span class="hljs-number">163</span>.com<span class="hljs-regexp">/ubuntu/</span> bionic-proposed main restricted universe multiverse<br>deb-src http:<span class="hljs-regexp">//mi</span>rrors.<span class="hljs-number">163</span>.com<span class="hljs-regexp">/ubuntu/</span> bionic-backports main restricted universe multiverse<br></code></pre></td></tr></table></figure><h4 id="清华源"><a href="#清华源" class="headerlink" title="清华源"></a>清华源</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk">mirrors.tuna.tsinghua.edu.cn     <span class="hljs-comment">#清华源</span><br><br><span class="hljs-comment">###############  你也可以选择先删光文件内容直接复制以下内容  ############</span><br><br>deb https:<span class="hljs-regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic main restricted universe multiverse<br>deb-src https:<span class="hljs-regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic main restricted universe multiverse<br>deb https:<span class="hljs-regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-updates main restricted universe multiverse<br>deb-src https:<span class="hljs-regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-updates main restricted universe multiverse<br>deb https:<span class="hljs-regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-backports main restricted universe multiverse<br>deb-src https:<span class="hljs-regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-backports main restricted universe multiverse<br>deb https:<span class="hljs-regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-security main restricted universe multiverse<br>deb-src https:<span class="hljs-regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-security main restricted universe multiverse<br>deb https:<span class="hljs-regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-proposed main restricted universe multiverse<br>deb-src https:<span class="hljs-regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="hljs-regexp">/ubuntu/</span> bionic-proposed main restricted universe multiverse<br></code></pre></td></tr></table></figure><p>结束后按<code>esc</code>退出编辑模式并输入<code>:wq</code>保存并退出<br>修改后更新源</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sudo apt-<span class="hljs-builtin-name">get</span> update<br>sudo apt-<span class="hljs-builtin-name">get</span> upgrade<br></code></pre></td></tr></table></figure><h2 id="搭建本地DNS服务器"><a href="#搭建本地DNS服务器" class="headerlink" title="搭建本地DNS服务器"></a>搭建本地DNS服务器</h2><p>搭建本地DNS服务器使用的是Dnsmasq</p><h3 id="安装Dnsmasq"><a href="#安装Dnsmasq" class="headerlink" title="安装Dnsmasq"></a>安装Dnsmasq</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">apt-<span class="hljs-builtin-name">get</span> install dnsmasq<br></code></pre></td></tr></table></figure><h3 id="配置Dnsmasq"><a href="#配置Dnsmasq" class="headerlink" title="配置Dnsmasq"></a>配置Dnsmasq</h3><h4 id="dnsmasq-conf"><a href="#dnsmasq-conf" class="headerlink" title="dnsmasq.conf"></a>dnsmasq.conf</h4><p>打开配置文件</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">vim <span class="hljs-regexp">/etc/</span>dnsmasq.conf<br></code></pre></td></tr></table></figure><p>按i打开编辑模式<br>去掉strict-order前面的#号<br>设置listen-address，配置如下：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute"><span class="hljs-nomarkup">listen</span></span>-address=<span class="hljs-number">127.0.0.1</span>,逗号后的这里请填写树莓派的内网IP地址<br></code></pre></td></tr></table></figure><p>修改缓存大小（就在目前打开的文件中添加以下内容即可）</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">cache-size</span>=<span class="hljs-number">10000</span><br></code></pre></td></tr></table></figure><h4 id="resolv-conf"><a href="#resolv-conf" class="headerlink" title="resolv.conf"></a>resolv.conf</h4><p>打开文件</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">vim <span class="hljs-regexp">/etc/</span>resolv.conf<br></code></pre></td></tr></table></figure><p>添加上游dns，格式如下</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">nameserver</span> 此处填写DNS地址，注意和前面的nameserver之间要有一个空格<br></code></pre></td></tr></table></figure><p>查询顺序自上而下，可以多添加几个上游DNS地址<br>按<code>esc</code>退出编辑模式<br>输入<code>:wq</code>保存并退出</p><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><p>启动</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">service dnsmasq restart</span><br></code></pre></td></tr></table></figure><p>查看运行状态</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">service dnsmasq status</span><br></code></pre></td></tr></table></figure><p>没有报错就说明安装成功了</p><h2 id="搭建透明代理"><a href="#搭建透明代理" class="headerlink" title="搭建透明代理"></a>搭建透明代理</h2><p>这里我们使用的是大名鼎鼎的<a target="_blank" rel="noopener" href="https://github.com/Dreamacro/clash/releases">clash</a></p><h3 id="安装clash"><a href="#安装clash" class="headerlink" title="安装clash"></a>安装clash</h3><p>找到<code>armv7</code>的包，复制链接并使用<code>wget</code>下载到机器（个人建议用能魔法上网的电脑先下载好之后上传到树莓派上，这里不介绍怎么传了）</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk">mkdir <span class="hljs-regexp">/home/</span>clash<br>cd <span class="hljs-regexp">/home/</span>clash<br>wget 此处填入前面找到的安装包的下载链接，比如写这篇文章时的是https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/Dreamacro/</span>clash<span class="hljs-regexp">/releases/</span>download<span class="hljs-regexp">/v0.19.0/</span>clash-linux-armv7-v0.<span class="hljs-number">19.0</span>.gz<br><br>gunzip clash-linux-armv7-v0.<span class="hljs-number">19.0</span>.gz     <span class="hljs-comment">#解压包，记得把文件名替换成你下载的文件的文件名</span><br>mv clash-linux-armv7-v0.<span class="hljs-number">19.0</span> <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>clash     <span class="hljs-comment">#将解压好的文件夹移动至/usr/local/bin/clash</span><br><br>chmod +x <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>clash    <span class="hljs-comment">#给权限</span><br></code></pre></td></tr></table></figure><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>配置文件怎么来的不解释，这里默认大家已经有配置文件了。<br>假设我们手上有一个配置文件（文件名为<code>a.yaml</code>，文件路径为<code>/home/clash/a.yaml</code>），且目前我们处于<code>/home/clash</code>这个文件夹中<br>重命名配置文件</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">mv <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.yaml</span> config.yaml<br></code></pre></td></tr></table></figure><h4 id="打开并修改配置文件"><a href="#打开并修改配置文件" class="headerlink" title="打开并修改配置文件"></a>打开并修改配置文件</h4><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">vim config.yaml<br></code></pre></td></tr></table></figure><p>将文件中的这两个配置修改成如下</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">allow-lan:</span> <span class="hljs-literal">true</span>    <span class="hljs-comment">#即允许来自局域网的连接</span><br><br><span class="hljs-attr">external-controller:</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><span class="hljs-string">:9090</span>    <span class="hljs-comment">#可以外部控制</span><br></code></pre></td></tr></table></figure><p>保存并退出</p><h3 id="启动clash"><a href="#启动clash" class="headerlink" title="启动clash"></a>启动clash</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">clash -d <span class="hljs-regexp">/home/</span>clash<br></code></pre></td></tr></table></figure><p>无错误输出的就是成功了</p><h3 id="守护程序"><a href="#守护程序" class="headerlink" title="守护程序"></a>守护程序</h3><p>这里介绍service，也可以选用pm2（推荐）</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">cd</span> /etc/systemd/<span class="hljs-built_in">system</span><br><span class="hljs-keyword">vim</span> clash.service<br></code></pre></td></tr></table></figure><p>在文件中添加如下内容</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-comment"># This is about to control clash&#x27;s start|stop|restart|status|enable</span><br><span class="hljs-section">[Unit]</span><br><span class="hljs-attr">Description</span>=Clash Service<br><span class="hljs-attr">After</span>=network.target<br><br><span class="hljs-section">[Service]</span><br><span class="hljs-attr">ExecStart</span>=/usr/local/bin/clash -d /home/clash<br><span class="hljs-attr">Restart</span>=<span class="hljs-literal">on</span>-abort<br><span class="hljs-attr">LimitNOFILE</span>=<span class="hljs-number">1048576</span><br><br><span class="hljs-section">[Install]</span><br><span class="hljs-attr">WantedBy</span>=multi-user.target<br></code></pre></td></tr></table></figure><p><strong>要注意<code>ExecStart=/usr/local/bin/clash -d /home/clash</code>这行使用的命令，如果按我的教程做的不需要修改，如果配置文件位置不一样的请自行做调整</strong><br>启动</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">systemctl <span class="hljs-literal">start</span> clash<br></code></pre></td></tr></table></figure><p>查看运行状态</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">systemctl status clash</span><br></code></pre></td></tr></table></figure><p>开机自启</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">systemctl <span class="hljs-builtin-name">enable</span> clash<br></code></pre></td></tr></table></figure><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>这样就完成了clash的设置，局域网内的设备就可以通过配置文件里设置的端口设置代理进行魔法上网了。（默认http是7890，socks是7891，请自行查看配置文件设置的端口）<br>想要外网访问的话需要路由器支持端口转发，请自行设置。<br>这里不介绍web管理页面怎么弄了，非常简单，GitHub上把文件下载到电脑点开文件夹里的<code>index.html</code>文件就能用（管理页面会要求填ip和端口号，ip是树莓派内网ip，端口号是之前在修改配置文件时提到的<code>external-controller: 0.0.0.0:9090</code>这里的9090)。</p><h2 id="使用cloudflareAPI实现DDNS"><a href="#使用cloudflareAPI实现DDNS" class="headerlink" title="使用cloudflareAPI实现DDNS"></a>使用cloudflareAPI实现DDNS</h2><p>事情是这样的，本来我想弄完上面两样就收工的，然后想想得折腾折腾让外网也能正常访问。但我家宽带是动态ip我使用的主路由是TP-LINK的企业级路由，虽然支持使用ddns但是只能使用固定那几家的（花生壳啥的），但我不想用。正好我有域名，且是cloudflare托管，就使用cloudflare的api来实现ddns。<br><strong>这里使用到的脚本来自这位<a target="_blank" rel="noopener" href="https://vircloud.net/author/1/">大神</a>的这篇文章（<a target="_blank" rel="noopener" href="https://vircloud.net/operations/cf-ddns.html">利用 CloudFlare API 实现自动 DDNS 功能|支持IPv4|IPv6</a>）,我家是IPv4所以我去掉了IPv6的内容，如需要请前往原文查看IPv6相关设置，这里就不多介绍了。</strong></p><h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br>auth_email=<span class="hljs-string">&quot;cloudflare账号邮箱&quot;</span><br>auth_key=<span class="hljs-string">&quot;api秘钥&quot;</span><br>zone_name=<span class="hljs-string">&quot;根域名&quot;</span><br>record_name=<span class="hljs-string">&quot;绑定公网ip的子域名&quot;</span><br><br>record_type=<span class="hljs-string">&quot;A&quot;</span><br>ip=$(curl -s http://members.3322.org/dyndns/getip)<br>ip_file=<span class="hljs-string">&quot;ip.txt&quot;</span><br>id_file=<span class="hljs-string">&quot;cloudflare.ids&quot;</span><br>log_file=<span class="hljs-string">&quot;cloudflare.log&quot;</span><br><span class="hljs-function"><span class="hljs-title">log</span></span>() &#123;<br>	<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>		<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;[<span class="hljs-subst">$(date)</span>] - <span class="hljs-variable">$1</span>&quot;</span> &gt;&gt; <span class="hljs-variable">$log_file</span><br>	<span class="hljs-keyword">fi</span><br>&#125;<br><span class="hljs-built_in">log</span> <span class="hljs-string">&quot;Check Initiated&quot;</span><br><br><span class="hljs-keyword">if</span> [ -f <span class="hljs-variable">$ip_file</span> ]; <span class="hljs-keyword">then</span><br>	old_ip=$(cat <span class="hljs-variable">$ip_file</span>)<br>	<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$ip</span>&quot;</span> == <span class="hljs-string">&quot;<span class="hljs-variable">$old_ip</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>		<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;IP has not changed.&quot;</span><br>		<span class="hljs-built_in">exit</span> 0<br>	<span class="hljs-keyword">fi</span><br><span class="hljs-keyword">fi</span><br><br><span class="hljs-keyword">if</span> [ -f <span class="hljs-variable">$id_file</span> ] &amp;&amp; [ $(wc -l <span class="hljs-variable">$id_file</span> | cut -d <span class="hljs-string">&quot; &quot;</span> -f 1) == 2 ]; <span class="hljs-keyword">then</span><br>	zone_identifier=$(head -1 <span class="hljs-variable">$id_file</span>)<br>	record_identifier=$(tail -1 <span class="hljs-variable">$id_file</span>)<br><span class="hljs-keyword">else</span><br>	zone_identifier=$(curl -s -X GET <span class="hljs-string">&quot;https://api.cloudflare.com/client/v4/zones?name=<span class="hljs-variable">$zone_name</span>&quot;</span> -H <span class="hljs-string">&quot;X-Auth-Email: <span class="hljs-variable">$auth_email</span>&quot;</span> -H <span class="hljs-string">&quot;X-Auth-Key: <span class="hljs-variable">$auth_key</span>&quot;</span> -H <span class="hljs-string">&quot;Content-Type: application/json&quot;</span> | grep -Po <span class="hljs-string">&#x27;(?&lt;=&quot;id&quot;:&quot;)[^&quot;]*&#x27;</span> | head -1 )<br>	record_identifier=$(curl -s -X GET <span class="hljs-string">&quot;https://api.cloudflare.com/client/v4/zones/<span class="hljs-variable">$zone_identifier</span>/dns_records?name=<span class="hljs-variable">$record_name</span>&amp;type=<span class="hljs-variable">$record_type</span>&quot;</span> -H <span class="hljs-string">&quot;X-Auth-Email: <span class="hljs-variable">$auth_email</span>&quot;</span> -H <span class="hljs-string">&quot;X-Auth-Key: <span class="hljs-variable">$auth_key</span>&quot;</span> -H <span class="hljs-string">&quot;Content-Type: application/json&quot;</span>  | grep -Po <span class="hljs-string">&#x27;(?&lt;=&quot;id&quot;:&quot;)[^&quot;]*&#x27;</span>)<br>	<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$zone_identifier</span>&quot;</span> &gt; <span class="hljs-variable">$id_file</span><br>	<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$record_identifier</span>&quot;</span> &gt;&gt; <span class="hljs-variable">$id_file</span><br><span class="hljs-keyword">fi</span><br><br>update=$(curl -s -X PUT <span class="hljs-string">&quot;https://api.cloudflare.com/client/v4/zones/<span class="hljs-variable">$zone_identifier</span>/dns_records/<span class="hljs-variable">$record_identifier</span>&quot;</span> -H <span class="hljs-string">&quot;X-Auth-Email: <span class="hljs-variable">$auth_email</span>&quot;</span> -H <span class="hljs-string">&quot;X-Auth-Key: <span class="hljs-variable">$auth_key</span>&quot;</span> -H <span class="hljs-string">&quot;Content-Type: application/json&quot;</span> --data <span class="hljs-string">&quot;&#123;\&quot;id\&quot;:\&quot;<span class="hljs-variable">$zone_identifier</span>\&quot;,\&quot;type\&quot;:\&quot;<span class="hljs-variable">$record_type</span>\&quot;,\&quot;name\&quot;:\&quot;<span class="hljs-variable">$record_name</span>\&quot;,\&quot;content\&quot;:\&quot;<span class="hljs-variable">$ip</span>\&quot;&#125;&quot;</span>)<br><br><span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$update</span> == *<span class="hljs-string">&quot;\&quot;success\&quot;:false&quot;</span>* ]]; <span class="hljs-keyword">then</span><br>	message=<span class="hljs-string">&quot;API UPDATE FAILED. DUMPING RESULTS:\n<span class="hljs-variable">$update</span>&quot;</span><br>	<span class="hljs-built_in">log</span> <span class="hljs-string">&quot;<span class="hljs-variable">$message</span>&quot;</span><br>	<span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-variable">$message</span>&quot;</span><br>	<span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">else</span><br>	message=<span class="hljs-string">&quot;IP changed to: <span class="hljs-variable">$ip</span>&quot;</span><br>	<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$ip</span>&quot;</span> &gt; <span class="hljs-variable">$ip_file</span><br>	<span class="hljs-built_in">log</span> <span class="hljs-string">&quot;<span class="hljs-variable">$message</span>&quot;</span><br>	<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$message</span>&quot;</span><br><span class="hljs-keyword">fi</span><br><br></code></pre></td></tr></table></figure><h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><p>先确定自家宽带目前的公网ip，并添加到CloudFlare的DNS记录中（不要打开CDN）<br>并在概述处找到api，获取<code>Global API Key</code>的秘钥</p><h4 id="制作脚本"><a href="#制作脚本" class="headerlink" title="制作脚本"></a>制作脚本</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">cd</span> /home<br><span class="hljs-keyword">vim</span> cfapi.<span class="hljs-keyword">sh</span><br></code></pre></td></tr></table></figure><p>填入上面提到的脚本，并将上面有中文的四行依次填入中文所示的信息后保存并退出。</p><h4 id="执行"><a href="#执行" class="headerlink" title="执行"></a>执行</h4><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata">chmod +x cfapi.<span class="hljs-keyword">sh</span><br>./cfapi.<span class="hljs-keyword">sh</span><br></code></pre></td></tr></table></figure><p>如果下面这个输出了宽带公网ip或显示ip为改变则说明成功了</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros">输出了这个<span class="hljs-built_in"></span><br><span class="hljs-built_in">IP </span>changed <span class="hljs-keyword">to</span>: ****<br>或者这个<span class="hljs-built_in"></span><br><span class="hljs-built_in">IP </span>has <span class="hljs-keyword">not</span> changed.<br>就是成功了<br></code></pre></td></tr></table></figure><h4 id="定时运行"><a href="#定时运行" class="headerlink" title="定时运行"></a>定时运行</h4><p>我家路由器每天四点重启，所以每天四点都会更新IP，我们需要做的就是让脚本定时运行，保证实时更新。</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">service cron <span class="hljs-literal">start</span>  <span class="hljs-comment">#启动定时执行工具</span><br>crontab -e  <span class="hljs-comment">#编辑配置</span><br></code></pre></td></tr></table></figure><p>第一次执行会显示让你选择使用的编辑工具，填对应数字并回车就行，我选择的是2（vim）<br>接着的操作和之前使用vim完全一样<br>这里我们填入以下命令</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">0 </span><span class="hljs-number">5</span> * * *  /home/cfapi.sh &gt;/dev/null <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>即每天五点运行一次脚本（具体含义可参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/allenlinrui/article/details/7490206">这篇文章</a>）<br>保存并退出<br>重启程序</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">service cron restart</span><br></code></pre></td></tr></table></figure><p>完成。</p><h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>折腾完了我也身心舒畅了，你说折腾这个有啥用其实也真没什么用。但也算是学到了不少新的知识吧。<br>写这篇文章花了我两个小时，从晚上八点半写到晚上十点半，真的累。创作不易，欢迎大家支持和资瓷。</p></div><hr><div><div class="post-metas mb-3"><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/tags/%E6%95%99%E7%A8%8B/">教程</a> <a class="hover-with-bg" href="/tags/DNS/">DNS</a> <a class="hover-with-bg" href="/tags/%E4%BB%A3%E7%90%86/">代理</a> <a class="hover-with-bg" href="/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/">树莓派</a> <a class="hover-with-bg" href="/tags/DDNS/">DDNS</a></div></div><p class="note note-warning">本博客所有文章包含标签（tag） # 随笔 的文章禁止转载!<br>除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p><div class="post-prevnext"><article class="post-prev col-6"><a href="/2020/05/27/cyber-security/"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">浅谈魔法上网的那些事</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2020/03/28/bt/"><span class="hidden-mobile">P2P下载小科普</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></div></div></div><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content"><a>Copyrights © 2019-2021 <a><a href="https://xianyu.one" target="_blank" rel="nofollow noopener"><span>Xianyu</span></a><br><a>Powered by <a><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <a>| <a><a>Theme by <a><a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></a></a></a></a></div></footer><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/img-lazyload.js"></script><script src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script><script src="/js/local-search.js"></script><script defer>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-149461686-1","auto"),ga("send","pageview")</script><script async src="https://www.google-analytics.com/analytics.js"></script><script src="/js/boot.js"></script></body></html>